# RabbitMQ Dashboard Guide

## Обзор

Дашборд **"RabbitMQ - JewelryStore EDA"** предназначен для мониторинга Event-Driven Architecture на базе RabbitMQ в системе JewelryStore.

## Доступ к дашборду

1. Откройте Grafana: http://localhost:3000
2. Войдите в систему (admin/admin123)
3. Найдите дашборд "RabbitMQ - JewelryStore EDA" в списке дашбордов

## Панели мониторинга

### 1. RabbitMQ Status
- **Тип**: Статус индикатор
- **Описание**: Показывает доступность RabbitMQ сервиса
- **Значения**: UP (зеленый) / DOWN (красный)
- **Источник**: `up{job="rabbitmq"}`

### 2. RabbitMQ Connections & Channels
- **Тип**: Временной график
- **Описание**: Отслеживает активные соединения и каналы
- **Метрики**:
  - `rabbitmq_connections` - активные соединения
  - `rabbitmq_channels` - активные каналы

### 3. JewelryStore Queue Messages (расширенная версия)
- **Тип**: Временной график
- **Описание**: Количество сообщений в очередях JewelryStore
- **Очереди**:
  - `orders.*` - очереди заказов
  - `products.*` - очереди продуктов
  - `notifications.*` - очереди уведомлений
  - `logs.*` - очереди логов

### 4. Message Rates
- **Тип**: Временной график
- **Описание**: Скорость публикации и обработки сообщений
- **Метрики**:
  - Published/sec - скорость публикации
  - Delivered/sec - скорость доставки

### 5. Queue Consumers
- **Тип**: Временной график
- **Описание**: Количество потребителей для каждой очереди
- **Метрика**: `rabbitmq_queue_consumers`

### 6. RabbitMQ Memory Usage
- **Тип**: Временной график
- **Описание**: Использование памяти RabbitMQ
- **Метрики**:
  - Used Memory - используемая память
  - Memory Limit - лимит памяти

### 7. Exchange Message Rates
- **Тип**: Временной график
- **Описание**: Статистика сообщений по обменам
- **Обмены**: orders, products, notifications, logs

### 8. Queue Status Overview
- **Тип**: Таблица
- **Описание**: Сводная таблица состояния всех очередей
- **Колонки**:
  - Queue Name - имя очереди
  - Messages - количество сообщений
  - Consumers - количество потребителей

## Интерпретация метрик

### Нормальные значения
- **Connections**: 1-10 (зависит от количества сервисов)
- **Channels**: 1-20 (обычно 1-2 канала на соединение)
- **Messages**: 0-5 (сообщения должны быстро обрабатываться)
- **Memory Usage**: < 512MB для тестовой среды

### Предупреждающие значения
- **Messages > 10**: Возможно замедление обработки
- **Memory > 1GB**: Высокое потребление памяти
- **Consumers = 0**: Нет потребителей для очереди

### Критические значения
- **Status = DOWN**: RabbitMQ недоступен
- **Messages > 100**: Очередь переполнена
- **Memory > 2GB**: Критическое потребление памяти

## Типичные сценарии мониторинга

### 1. Проверка работоспособности
- Убедитесь, что Status = UP
- Проверьте наличие активных соединений
- Убедитесь, что есть потребители для всех очередей

### 2. Мониторинг производительности
- Отслеживайте скорость обработки сообщений
- Следите за накоплением сообщений в очередях
- Контролируйте использование памяти

### 3. Диагностика проблем
- Проверьте статус RabbitMQ при недоступности
- Найдите очереди с накопившимися сообщениями
- Выявите очереди без потребителей

## Настройка алертов

Рекомендуемые алерты:
1. **RabbitMQ Down**: `up{job="rabbitmq"} == 0`
2. **High Queue Length**: `rabbitmq_queue_messages > 50`
3. **No Consumers**: `rabbitmq_queue_consumers == 0`
4. **High Memory Usage**: `rabbitmq_process_resident_memory_bytes > 1073741824`

## Связь с архитектурой JewelryStore

### Event-Driven Architecture
Дашборд отражает EDA паттерны:
- **Direct Exchange** (orders.exchange) - обработка заказов
- **Fanout Exchange** (products.exchange) - обновления продуктов
- **Topic Exchange** (notifications.exchange) - уведомления
- **Headers Exchange** (logs.exchange) - логирование

### Интеграция с сервисами
- **API** публикует события заказов и обновлений продуктов
- **UI** подписывается на уведомления
- **Background Services** обрабатывают асинхронные задачи

## Troubleshooting

### Отсутствие данных
1. Проверьте, что RabbitMQ Exporter запущен (порт 9419)
2. Убедитесь, что Prometheus собирает метрики с RabbitMQ
3. Проверьте targets в Prometheus: http://localhost:9090/targets

### Неточные метрики
1. Перезапустите RabbitMQ Exporter
2. Проверьте конфигурацию в docker-compose.yml
3. Убедитесь, что RabbitMQ Management API доступен

### Проблемы с производительностью
1. Увеличьте ресурсы для RabbitMQ контейнера
2. Оптимизируйте обработку сообщений в приложении
3. Рассмотрите использование дополнительных потребителей 